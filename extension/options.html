<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Web Pentest Companion — Settings</title>
    <link rel="stylesheet" href="styles/tailwind.css" />
  </head>
  <body class="app-shell min-h-screen">
    <main class="options-shell max-w-4xl mx-auto py-8">
      <header class="options-header">
        <div class="brand-lockup">
          <span class="brand-mark">VG</span>
          <div>
            <p class="text-xs uppercase tracking-wide text-slate-400">Vanguard Scanner</p>
            <h1 class="text-2xl font-semibold">Extension Control Center</h1>
            <p class="text-sm text-slate-400">Stay in sync with the dashboard theme and defaults.</p>
          </div>
        </div>
        <div class="cloud-pill">Cloud API • vanguard-api-h9x9.onrender.com</div>
      </header>

      <section class="step-card" id="accountSection">
        <div class="step-heading">
          <span class="step-index">01</span>
          <div>
            <h2>Account & Authentication</h2>
            <p>Sign in with the same credentials you use on the dashboard.</p>
          </div>
          <span id="optionsAuthStatus" class="status-pill">Signed out</span>
        </div>
        <form id="optionsAuthForm" class="form-grid">
          <input type="email" name="email" placeholder="Email (min 8 char password)" class="input" required />
          <input type="password" name="password" placeholder="Password (minimum 8 characters)" class="input" required />
          <div class="flex gap-2">
            <button type="submit" class="btn btn-primary flex-1">Sign In</button>
            <button type="button" id="optionsRegisterBtn" class="btn btn-muted">Register</button>
          </div>
        </form>
        <div class="flex gap-2 mt-2">
          <button id="optionsLogoutBtn" class="btn btn-danger hidden">Sign Out</button>
          <button type="button" id="testApiBtn" class="btn btn-outline">Test API Connection</button>
        </div>
      </section>

      <section class="step-card">
        <div class="step-heading">
          <span class="step-index">02</span>
          <div>
            <h2>API connection</h2>
            <p>Same FastAPI instance the web app uses.</p>
          </div>
        </div>
        <form id="settingsForm" class="form-grid">
          <label class="form-grid">
            <span class="text-xs text-slate-400 uppercase tracking-wide">API Base URL</span>
            <input type="url" name="apiBaseUrl" class="input" placeholder="https://scanner.yourdomain.com" required />
          </label>
          <label class="form-grid">
            <span class="text-xs text-slate-400 uppercase tracking-wide">API Key</span>
            <div class="input-helper">
              <input type="text" name="apiKey" class="input" placeholder="Paste deployment key" />
              <small>Sent as <code>X-API-Key</code> on every request.</small>
            </div>
          </label>
          <label class="form-grid">
            <span class="text-xs text-slate-400 uppercase tracking-wide">Default scan mode</span>
            <select name="defaultMode" class="input">
              <option value="ultra-safe">Ultra Safe</option>
              <option value="safe">Safe</option>
              <option value="standard">Standard</option>
              <option value="aggressive">Aggressive</option>
            </select>
          </label>
          <label class="setting-toggle">
            <div>
              <p class="font-semibold">Playwright crawler by default</p>
              <small>Mirror the website’s “JS mode” toggle.</small>
            </div>
            <input type="checkbox" name="useJsCrawler" class="toggle" />
          </label>
          <label class="form-grid">
            <span class="text-xs text-slate-400 uppercase tracking-wide">Polling interval (ms)</span>
            <input type="number" name="pollingIntervalMs" class="input" min="2000" step="500" />
          </label>
          <label class="setting-toggle">
            <div>
              <p class="font-semibold">Passive checks</p>
              <small>Run lightweight DOM/header lint before API submission.</small>
            </div>
            <input type="checkbox" name="passiveChecksEnabled" class="toggle" />
          </label>
          <div class="flex gap-2">
            <button type="submit" class="btn btn-primary flex-1">Save</button>
            <button type="button" id="testConnection" class="btn btn-muted">Test connection</button>
            <button type="button" id="resetDefaults" class="btn btn-danger">Reset defaults</button>
          </div>
          <p id="settingsStatus" class="text-sm text-slate-400"></p>
        </form>
      </section>

      <section class="step-card" data-auth-locked>
        <div class="step-heading">
          <span class="step-index">03</span>
          <div>
            <h2>Local schedules</h2>
            <p>Only stored in this browser profile.</p>
          </div>
        </div>
        <form id="scheduleForm" class="schedule-grid">
          <input type="url" name="target" placeholder="https://example.com" class="input" required />
          <select name="frequency" class="input">
            <option value="daily">Daily</option>
            <option value="weekly">Weekly</option>
            <option value="monthly">Monthly</option>
          </select>
          <button class="btn btn-primary">Add</button>
        </form>
        <ul id="scheduleList" class="history-list text-sm mt-4"></ul>
      </section>
    </main>

    <template id="scheduleItemTemplate">
      <li class="schedule-item">
        <div>
          <p class="font-semibold text-white data-target"></p>
          <p class="text-xs text-slate-400 data-frequency"></p>
        </div>
        <button class="btn btn-muted text-xs data-remove">Remove</button>
      </li>
    </template>

    <script type="module" src="options.js"></script>
  </body>
</html>
